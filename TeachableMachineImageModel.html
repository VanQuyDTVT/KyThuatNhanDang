<script>
//*********************************************//
//Create by Le Van Quy DT3 DUT
//Date: 2021/09/16 07:00AM
//Github: https://github.com/VanQuyDTVT
//Facebook: https://www.facebook.com/vanquy2406
//Gmail: levanquy.dhbk@gmail.com
//*********************************************//
</script>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kỹ Thuật Nhận Dạng | Văn Quý 18DT3</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <script
      src="https://use.fontawesome.com/releases/v5.15.4/js/all.js"
      data-auto-a11y="true"
    ></script>
</head>
<body>
    <div id="nofitication1" style="z-index:999;opacity: 50% ;position:absolute;width:100%;height:100%;background-color: rgb(0, 0, 0);" >a </div>
    <h1 id="nofitication2" style="z-index:9999;position:absolute;left: 20%;right: 20% ; top:5%;">
        <div type="button" class="btn btn-primary">
            <center style="font-family:Cambria;" class="fs-1 fw-bold">
                Teachable Machine Image Model
            </center>
            <c class="fst-italic">Create by Van Quy 18DT3</c>
            <div class="fs-3 fw-bolder text-start" > <i class="far fa-newspaper"></i> Introduce</div>
            <center class="fs-4">
                The system used for <c class="fst-italic">image recognition</c> is based on <c class="fst-italic">Google's Teachable Machine</c> module
                <br>
                <div class="fs-3 fw-bolder text-start" ><i class="fas fa-toolbox"></i> Feature</div>
                Use webcam to identify objects such as <c class="fst-italic">pens</c> and <c class="fst-italic">calculators</c>, while other objects will result <c class="fst-italic">"Unknow"</c>
                <br>
                <div class="fs-3 fw-bolder text-start" ><i class="far fa-file-alt"></i> Guide</div>
                <p class="text-start" style="margin-left: 50px;">
                    <i class="fas fa-arrow-alt-circle-right"></i> Click <c class="fst-italic">START</c><br>
                    <i class="fas fa-arrow-alt-circle-right"></i> Wait a moment for the system to boot <br>
                    <i class="fas fa-arrow-alt-circle-right"></i> Put the objects in front of your webcam one by one the system will tell you what it is
                </p>
            </center>
            <button type="button" style="border-radius:25px 25px 25px 25px; color: rgb(13,110,253);" 
                class="btn btn-light primary fs-4 fw-bolder" onclick="closeNofitication()">Try Now !!!</button>
        </div>
    </h1>
    <center>
        <a href="./TeachableMachineImageModel.html">
            <div class="p-3 mb-2 bg-primary text-light fw-bolder fs-2" >Teachable Machine Image Model</div>
        </a>
        <br>
        <div class="badge bg-success text-wrap fs-2" id="label-container"></div>
        <br>
        <button style="margin-top:160px;"  id="state" type="button" class="btn btn-outline-primary fw-bolder fs-2" onclick="init()">Start</button>
        <div id="webcam-container"></div>
        <div></div>
    </center>

    <h1 style="position: fixed;left: 90%;top: 35%;font-size:80px;" >
        <a href="https://github.com/VanQuyDTVT/KyThuatNhanDang">
            <i style="margin-bottom: 20px;" class="fab fa-github primary" title="View Source Code On GitHub"></i>
        </a><br >
        <a href="https://www.facebook.com/vanquy2406">
            <i style="margin-bottom: 8px;" class="fab fa-facebook" title="Contact Me on Facebook"></i>
        </a><br>
        <a href="mailto: levanquy01693099717@gmail.com">
            <i class="fas fa-envelope" title="Contact Me via Mail"></i>
        </a><br>
    </h1>
    <h1 style="position: fixed;left: 4%;top: 30%;font-size:80px;" >
        <center>
            <button onclick="onNoti(1)" type="button" class="btn">
                <i style="color: rgb(13,110,253);font-size:80px;margin-bottom: -2px;" class="far fa-newspaper"  title="Introduce"></i>
            </button><br>
            <button onclick="onNoti(2)" type="button" class="btn">
                <i style="color: rgb(13,110,253);font-size:80px;" class="fas fa-toolbox" title="Feature"></i>
            </button><br>
            <button onclick="onNoti(3)" type="button" class="btn">
                <i style="color: rgb(13,110,253);font-size:80px;" class="far fa-file-alt" title="Guide"></i>
            </button><br>
        </center>
    </h1>
    <h1 id=nofitication5 style="position:absolute;position:absolute;left:13%;right:65%;top:32%;visibility:hidden;">
        <i class="fas fa-caret-left" style="z-index:-1;position:absolute;left:-13px;top:30px;color:rgb(13,110,253);"></i>
        <div type="button" class="btn btn-primary" style="border-radius: 20px 50px 20px 30px;" >
            <div class="fs-3 fw-bolder text-start">
                Introduce
            </div>
            <div class="fs-5 text-start">
                The system used for <c class="fst-italic">image recognition</c>
                 is based on <c class="fst-italic">Google's Teachable Machine</c> module
            </div>
        </div>    
    </h1>
    <h1 id=nofitication6 style="position:absolute;position:absolute;left: 13%;right:65% ; top:49%;visibility:hidden">
        <i class="fas fa-caret-left" style="z-index:-1;position:absolute;left:-13px;top:30px;color:rgb(13,110,253);"></i>
        <div type="button" class="btn btn-primary" style="border-radius: 20px 50px 20px 30px;" >
            <div class="fs-3 fw-bolder text-start">
                Feature
            </div>
            <div class="fs-5 text-start" >
                Use webcam to identify objects such as <c class="fst-italic">pens</c> and <c class="fst-italic">calculators</c>
                , while other objects will result <c class="fst-italic">"Unknow"</c>
            </div>
        </div>    
    </h1>
    <h1 id=nofitication7 style="position:absolute;position:absolute;left: 13%;right:65% ; top:55%;visibility:hidden">
        <i class="fas fa-caret-left" style="z-index:-1;position:absolute;left:-13px;top:95px;color:rgb(13,110,253);"></i>
        <div type="button" class="btn btn-primary" style="border-radius: 20px 50px 20px 30px;">
            <div class="fs-3 fw-bolder text-start">
                Guide
            </div>
            <div class="fs-5 text-start">
                <p class="text-start">
                    <i class="fas fa-arrow-alt-circle-right"></i> Click <c class="fst-italic">START</c><br>
                    <i class="fas fa-arrow-alt-circle-right"></i> Wait a moment for the system to boot <br>
                    <i class="fas fa-arrow-alt-circle-right"></i> Put the objects in front of your webcam one by one the system will tell you what it is
                </p>
            </div>
        </div>    
    </h1>
    
    <script>
        pub=0;
        function onNoti(s){
            if (pub==s){
                switch (s){
                    case 1:{document.getElementById('nofitication5').style.visibility = 'hidden';break;}
                    case 2:{document.getElementById('nofitication6').style.visibility = 'hidden';break;}
                    case 3:{document.getElementById('nofitication7').style.visibility = 'hidden';break;}
                }
                pub=0;
            }
            else {
                switch (s){
                    case 1:{document.getElementById('nofitication5').style.visibility = '';
                            document.getElementById('nofitication6').style.visibility = 'hidden';
                            document.getElementById('nofitication7').style.visibility = 'hidden';
                            break;}
                    case 2:{document.getElementById('nofitication5').style.visibility = 'hidden';
                            document.getElementById('nofitication6').style.visibility = '';
                            document.getElementById('nofitication7').style.visibility = 'hidden';
                            break;}
                    case 3:{document.getElementById('nofitication5').style.visibility = 'hidden';
                            document.getElementById('nofitication6').style.visibility = 'hidden';
                            document.getElementById('nofitication7').style.visibility = '';
                            break;}
                }
                pub=s;
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
    <script type="text/javascript">
        // More API functions here:
        // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

        // the link to your model provided by Teachable Machine export panel
        const URL = "https://teachablemachine.withgoogle.com/models/LZCxW0Apd/";

        let model, webcam, labelContainer, maxPredictions;
        let firstStart=1, pauseWebcam=0;
        // Load the image model and setup the webcam
        function closeNofitication(){
            document.getElementById('nofitication1').style.visibility = 'hidden';
            document.getElementById('nofitication2').style.visibility = 'hidden';
        }
        async function init() {
            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";
            document.getElementById("state").innerText="Starting...";
            // load the model and metadata
            // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
            // or files from your local hard drive
            // Note: the pose library adds "tmImage" object to your window (window.tmImage)
            model = await tmImage.load(modelURL, metadataURL);
            maxPredictions = model.getTotalClasses();

            // Convenience function to setup a webcam
            const flip = true; // whether to flip the webcam
            webcam = new tmImage.Webcam(400, 400, flip); // width, height, flip
            
            await webcam.setup(); // request access to the webcam
            await webcam.play();
            window.requestAnimationFrame(loop);
            
            document.getElementById('state').style="";
            document.getElementById('state').classList= "fs-6";
            document.getElementById('state').style.visibility = 'hidden';
            
            // append elements to the DOM;
            document.getElementById("webcam-container").appendChild(webcam.canvas);
            labelContainer = document.getElementById("label-container");
            labelContainer.appendChild(document.createElement("div"));
    
        }

        async function loop() {
            webcam.update(); // update the webcam frame
            await predict();
            window.requestAnimationFrame(loop);
        }

        // run the webcam image through the image model
        async function predict() {
            // predict can take in an image, video or canvas html element
            const prediction = await model.predict(webcam.canvas);
            max=prediction[0].probability.toFixed(2);
            pos=0;
            for (let i = 1; i < maxPredictions; i++) {
                if (max<prediction[i].probability.toFixed(2)) 
                {
                    max=prediction[i].probability.toFixed(2);
                    pos=i;
                }
            }
            if (pos==2){
                classPrediction = "Unknown";
            }
            else classPrediction = prediction[pos].className;
            labelContainer.innerHTML = classPrediction;
        }
    </script>

</body>
</html>

<script>
//End Code
//Thanks for Watching
//Have a good day <3
//Add line 
//Add new feature
</script>
